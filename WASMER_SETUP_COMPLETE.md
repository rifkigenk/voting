# âœ… Wasmer PHP Setup - Complete Configuration

Your MPS Voting Application is now configured for **full PHP deployment** to Wasmer Edge!

## ğŸ¯ What's Been Set Up

### Files Created/Updated for Wasmer PHP:

1. **Dockerfile** âœ…
   - PHP 8.2 with Apache
   - MySQLi extension installed
   - Configured for port 8080
   - Production-ready

2. **wasmer.toml** âœ…
   - PHP/Docker mode
   - MySQL 8.4 addon configured
   - CORS enabled for all endpoints
   - Automatic health checks
   - Cache configuration

3. **docker-compose.yml** âœ…
   - PHP service with Dockerfile
   - MySQL 8.4 service
   - PhpMyAdmin for management
   - Health checks
   - Auto-restart enabled

4. **deploy-wasmer-php.bat** âœ…
   - Windows deployment script
   - Tests locally first
   - Then deploys to Wasmer
   - Interactive prompts

5. **deploy-wasmer-php.sh** âœ…
   - Linux/Mac deployment script
   - Same workflow as .bat
   - Colored output

6. **Documentation** âœ…
   - WASMER_PHP_DEPLOYMENT.md - Complete guide
   - WASMER_QUICK_REFERENCE.md - Quick reference
   - This file - Setup summary

---

## ğŸš€ How to Deploy

### Quick Start (Easiest)

#### Windows Users:
```powershell
cd "d:\XAMPP\htdocs\Projek MPS\mps-voting"
.\deploy-wasmer-php.bat
```

#### Linux/Mac Users:
```bash
cd "~/path/to/mps-voting"
chmod +x deploy-wasmer-php.sh
./deploy-wasmer-php.sh
```

### What the Script Does:
1. âœ… Checks Docker & Wasmer installed
2. âœ… Builds Docker image
3. âœ… Starts containers locally
4. âœ… Tests PHP endpoints
5. âœ… Deploys to Wasmer
6. âœ… Shows your live URL

---

## ğŸ“‹ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Your Browser                          â”‚
â”‚      (http://localhost:80)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTP Requests
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Apache PHP Server                       â”‚
â”‚      (FROM php:8.2-apache)                      â”‚
â”‚     â”œâ”€ index.html (served as-is)               â”‚
â”‚     â”œâ”€ /php/*.php (executed)                   â”‚
â”‚     â”œâ”€ /style/ (static files)                  â”‚
â”‚     â””â”€ Font recognition JS                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ SQL Queries
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MySQL Database                          â”‚
â”‚      (MySQL 8.4)                                â”‚
â”‚     â”œâ”€ voters table                            â”‚
â”‚     â”œâ”€ candidates table                        â”‚
â”‚     â”œâ”€ votes table                             â”‚
â”‚     â””â”€ admin table                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Deployment Locations

### Local Testing (Docker)
```
URL: http://localhost
Database: localhost:3306
User: mps_voting
Password: mps_voting_2026
```

### Production (Wasmer Edge)
```
URL: https://mps-voting.rifkigenk.wasmer.app
Database: mysql.internal (managed by Wasmer)
User: mps_voting
Password: Auto-generated by Wasmer
```

---

## âœ… Pre-Deployment Checklist

Before you deploy, ensure:

- [ ] Docker Desktop installed (https://www.docker.com/products/docker-desktop)
- [ ] Wasmer CLI installed (https://docs.wasmer.io/ecosystem/wasmer/getting-started)
- [ ] Wasmer account created (https://wasmer.io)
- [ ] GitHub account (optional, for auto-deploy)
- [ ] `Dockerfile` exists âœ…
- [ ] `wasmer.toml` exists âœ…
- [ ] `docker-compose.yml` exists âœ…
- [ ] `deploy-wasmer-php.bat/sh` exists âœ…

---

## ğŸ”§ Environment Variables

### Automatic (Set by Wasmer)
```
DATABASE_HOST = mysql.internal
DATABASE_USER = mps_voting
DATABASE_NAME = mps_voting
DATABASE_PORT = 3306
```

### Optional (You Can Set)
```
ENVIRONMENT = production
TIMEZONE = Asia/Jakarta
PHP_MEMORY_LIMIT = 256M
MAX_EXECUTION_TIME = 30
```

### Secrets (Set in Wasmer Dashboard)
```
DATABASE_PASSWORD = [Wasmer auto-generates secure password]
```

---

## ğŸ“Š Local Testing (Before Deploying)

### 1. Build Docker Image
```bash
docker build -t mps-voting-php .
```

### 2. Start Containers
```bash
docker-compose up -d
```

### 3. Access Locally
```
App: http://localhost
PhpMyAdmin: http://localhost:8080
Database Host: mysql
Database User: mps_voting
Database Password: mps_voting_2026
```

### 4. Test PHP
```bash
# Test results page
curl http://localhost/php/results.php

# Test admin login
curl -X POST http://localhost/php/admin_login.php \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

### 5. Stop Containers
```bash
docker-compose down
```

---

## ğŸ¯ Deployment Commands

### Via CLI (Fastest)
```bash
wasmer login
wasmer deploy --name mps-voting
```

### Via Web UI (Most User-Friendly)
1. Go to https://app.wasmer.io
2. Click "New Project"
3. Select "Deploy from Git" or "Upload"
4. Choose template: PHP
5. Configure MySQL 8.4
6. Click Deploy

### Via Script (Automated - Recommended)
```bash
./deploy-wasmer-php.bat  # Windows
./deploy-wasmer-php.sh   # Linux/Mac
```

---

## âœ¨ After Deployment

### Check if Live
```bash
wasmer list
wasmer describe --name mps-voting
```

### View Logs
```bash
wasmer logs --name mps-voting --follow
```

### Access Your App
```
https://mps-voting.rifkigenk.wasmer.app
```

### Test Endpoints
```bash
curl https://mps-voting.rifkigenk.wasmer.app/php/results.php
curl https://mps-voting.rifkigenk.wasmer.app/php/voter_login.php
```

---

## ğŸ” Security Notes

1. **Change Admin Password** (First thing!)
   - Default: `admin123` â†’ Change to strong password
   - Update in database: `UPDATE admin SET password=MD5('newpassword')`

2. **Database Backups** (Automatic)
   - Wasmer handles backups automatically
   - You can also create manual backups

3. **HTTPS** (Automatic)
   - Wasmer provides free SSL certificates
   - All traffic encrypted

4. **Rate Limiting** (Available)
   - Can be configured in wasmer.toml

---

## ğŸ“ Getting Help

### Documentation Files
- `WASMER_PHP_DEPLOYMENT.md` - Complete guide
- `WASMER_QUICK_REFERENCE.md` - Quick commands
- `docker-compose.yml` - Container definitions
- `Dockerfile` - Image configuration

### External Resources
- **Wasmer Docs**: https://docs.wasmer.io
- **PHP Docker**: https://hub.docker.com/_/php
- **MySQL Docs**: https://dev.mysql.com/doc
- **Community**: https://discord.gg/ZwZUJmS

---

## ğŸ‰ You're Ready to Deploy!

Everything is configured and ready. Choose your deployment method:

### Option 1: Automated Script (Recommended)
```
Run: .\deploy-wasmer-php.bat  (Windows)
     ./deploy-wasmer-php.sh   (Linux/Mac)
```

### Option 2: Manual Deployment
```
1. wasmer login
2. wasmer deploy --name mps-voting
3. Wait 5-10 minutes
4. Access: https://mps-voting.rifkigenk.wasmer.app
```

### Option 3: Web UI
```
1. Go to app.wasmer.io
2. Create new project
3. Choose PHP template
4. Connect MySQL
5. Deploy
```

---

## âœ… Next Steps

1. **Deploy** using one of the methods above
2. **Wait** 5-10 minutes for Wasmer to provision
3. **Access** your live app
4. **Test** voter login (NISN: 12345678901, Name: Budi Santoso)
5. **Share** your app URL with voters

---

**Status**: âœ¨ Ready for Production Deployment

**Last Updated**: February 7, 2026
**PHP Version**: 8.2 with Apache
**Database**: MySQL 8.4
**Hosting**: Wasmer Edge
